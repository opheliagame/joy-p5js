<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>joy(x)p5js - fosshack 2021 üë©‚Äçüíª</title>

    <link rel="stylesheet" type="text/css" href="/style.css">
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.5.0/prism-material-light.min.css" integrity="sha512-O5jY0oTgD2Elx8HWIERZc4ZpMfpXeTdmz03FfAWoieGoa940jVMFC4sm183QCcvHlQTmTgoV5im5KFPwj4B5xg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <script src="https://cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- codemirror cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.63.3/codemirror.min.js" integrity="sha512-XMlgZzPyVXf1I/wbGnofk1Hfdx+zAWyZjh6c21yGo/k1zNC4Ve6xcQnTDTCHrjFGsOrVicJsBURLYktVEu/8vQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.63.3/codemirror.min.css" integrity="sha512-6sALqOPMrNSc+1p5xOhPwGIzs6kIlST+9oGWlI4Wwcbj1saaX9J3uzO3Vub016dmHV7hM+bMi/rfXLiF5DNIZg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.63.3/mode/javascript/javascript.min.js" integrity="sha512-DJ/Flq7rxJDDhgkO49H/rmidX44jmxWot/ku3c+XXEF9XFal78KIpu7w6jEaQhK4jli1U3/yOH+Rp3cIIEYFPQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.10.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.10.0/addons/p5.sound.min.js"></script>
    <script src="/dist/joy.p5.js"></script>

    <style>
      .CodeMirror {
        font-family: 'Courier New', Courier, monospace;
        font-size: medium;
      }
    </style>
  </head>
  
  <body>

    <div class="container mx-auto px-8 lg:px-10 py-10 md:text-lg">
      <a href="https://github.com/opheliagame/joy-p5js">
        <h1 class="text-4xl md:text-6xl text-blue-500 underline">joy.js</h1>
      </a>
     
      <br>

      <div class="px-2">
        <button class="bg-gray-100 px-2" id="runButton">Run</button>
        <button class="bg-gray-100 px-2" id="saveButton">Save</button>
        <div class="flex flex-col md:flex-row py-2">
          <div class="flex-auto w-1/2">
            <textarea class="code font-mono text-sm">c = circle()</textarea>
          </div>

          <div class="flex-initial">
            <div class="sketch border"></div>
            <div class="error-log text-red-500">
              errors will be reported here
            </div>
          </div>
        </div>
      </div>

    </div>

    <script>
     
      var myCodeMirror = CodeMirror.fromTextArea(document.querySelector('.code'), {
        lineNumbers: true,
        mode: {name: "javascript", json: true},
        matchBrackets: true,
        autoCloseBrackets: true, 
      });

      let runButton = document.getElementById('runButton')
      let errorLog = document.querySelector('.error-log')
      runButton.addEventListener('click', () => {
        let codeToRun = myCodeMirror.getValue()
        // sk.background(255)
        // sk.smooth()
        // drawGrid(sk)

        try {
          eval(codeToRun)
          errorLog.innerHTML = ''
        } catch(error) {
          console.log('eval')
          console.log(error)
          errorLog.innerHTML = error
        }

        
        // sk.draw = new Function(codeToRun)
        
      }) 

      // saving frame 
      let saveButton = document.getElementById('saveButton')
      saveButton.addEventListener('click', () => {
        sk.save('canvas.jpg')
      })
    </script>


  </body>
</html>
